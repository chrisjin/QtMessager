#ifndef V_PHONE_H
#define V_PHONE_H

#include <QObject>
#include<QDomDocument>
#include<QDomElement>
#include<QHostAddress>
#include<QFile>
#include"v_connectsocket.h"
#include"v_phonegui.h"
#include"v_smsmanager.h"
#include"v_personmanager.h"
/////////////////////////////////////////////////////////////
////
////
////数据，界面，网络通信的交换中心。负责程序的核心事务
////
////
/////////////////////////////////////////////////////////////
class V_Phone : public QObject
{
    Q_OBJECT
public:
    explicit V_Phone(QObject *parent = 0);
//    QObject

    QString PhoneNum;//本机号码
    QString ServerIP;//服务器IP
    QString IP;      //本机IP
    QString KeyWords;//短息敏感词
    bool IsOn;       //是否连接服务器
    V_ConnectSocket ConnectSocket;   //socket
    V_PhoneGUI PhoneGUI;             //界面外观
    V_SmsManager SmsManager;         //短息管理中心
    V_PersonManager PersonManager;   //联系人管理中心
    bool checkSms(QString con);      //检测短信是否有敏感词
    //////////////////////////////////
    /////初始化 读取配置信息，关联信号和槽
    ////////////////////////////////
    void init();
    //////////////////////////////////
    /////显示主界面
    ////////////////////////////////
    void show();
    //////////////////////////////////
    /////发送短信
    ////////////////////////////////
    void sendMessage(QString Num,QString con);
    //////////////////////////////////
    /////obsolete
    ////////////////////////////////
    void GUIconnect();
    //////////////////////////////////
    /////更新联系人列表控件，跟PersonManager同步
    ////////////////////////////////
    void updatePerson();
    //////////////////////////////////
    /////更新短信列表控件，跟SmsManager同步
    ////////////////////////////////
    void updateMessage();
    //////////////////////////////////
    /////更新收件箱列表控件，跟SmsManager同步
    ////////////////////////////////
    void updateMailBox();
    //////////////////////////////////
    /////更新垃圾箱列表控件，跟SmsManager同步
    ////////////////////////////////
    void updateRubbishBin();

signals:
    
public slots:
    //////////////////////////////////
    //开机连接服务器
    ////////////////////////////////
    void turnOn();
    //////////////////////////////////
    //关机  发送关机数据包
    ////////////////////////////////
    void turnOff();
    //////////////////////////////////
    //收到数据时调用   读取短信
    ////////////////////////////////
    void onReadyRead();
    //////////////////////////////////
    /////连接上服务时调用   发送开机数据包
    ////////////////////////////////
    void onConnected();
    //////////////////////////////////
    /////发送短信
    ////////////////////////////////
    void onSendBtn();
    //////////////////////////////////
    /////暂未使用
    ////////////////////////////////
    void onDestroy();
    //////////////////////////////////
    /////关机时调用  调用turnoff发送关机数据包
    ////////////////////////////////
    void onClose();
    //////////////////////////////////
    /////进入首发短信界面时调用  数据同步
    ////////////////////////////////
    void onMessageList();
    //////////////////////////////////
    /////加联系人时调用  数据同步
    ////////////////////////////////
    void onAddPerson(QString a,QString b);
    //////////////////////////////////
    /////删除短信时调用  数据同步
    ////////////////////////////////
    void onDeleteItem(int ID);
    //////////////////////////////////
    /////按号码删除短信调用  数据同步
    ////////////////////////////////
    void onDeleteItembyNum(QString Num);
    //////////////////////////////////
    /////拉进黑名单调用  数据同步
    ////////////////////////////////
    void onSetBlack(QString Num);
    //////////////////////////////////
    /////开机按钮  数据同步
    ////////////////////////////////
    void onTurnonBtn();
    //////////////////////////////////
    ////删除联系人  数据同步
    ////////////////////////////////
    void onDeletePerson(QString Num);
    void onDeleteIrevByNum(QString Num);
    
};

#endif // V_PHONE_H
